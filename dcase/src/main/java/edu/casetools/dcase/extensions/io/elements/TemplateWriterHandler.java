package edu.casetools.dcase.extensions.io.elements;

import java.io.IOException;

import edu.casetools.dcase.extensions.io.FakeData;
import edu.casetools.dcase.extensions.io.MData;
import edu.casetools.dcase.extensions.io.templates.MTemplateWriter;
import edu.casetools.dcase.extensions.io.templates.STRTemplateWriter;

public class TemplateWriterHandler {
    private StringBuilder result;
    private MData systemData;

    public TemplateWriterHandler(StringBuilder writer, MData systemData) {
	this.result = writer;
	this.systemData = systemData;
    }

    public void writeTemplates() throws IOException {
	result = new MTemplateWriter(result, systemData).write();
	createEvent();
	createTemporalOperators();
	result = new STRTemplateWriter(result, systemData).write();
	createNextTimeRules();
    }

    private void createEvent() throws IOException {
	if (FakeData.EVENT_NO > 0) {
	    result.append(
		    "\t<template>\r\n\t\t<name>Event</name>\r\n\t\t<parameter>const id_e id, const iter i, const id_s id_state, const bool status</parameter>\r\n\t\t<location id=\"id0\" x=\"306\" y=\"-170\">\r\n\t\t\t<name x=\"331\" y=\"-179\">NotTriggered</name>\r\n\t\t\t<label kind=\"exponentialrate\" x=\"314\" y=\"-204\">1</label>\r\n\t\t</location>\r\n\t\t<location id=\"id1\" x=\"8\" y=\"-170\">\r\n\t\t\t<name x=\"-77\" y=\"-179\">Triggered</name>\r\n\t\t\t<label kind=\"exponentialrate\" x=\"-17\" y=\"-204\">1</label>\r\n\t\t</location>\r\n\t\t<location id=\"id2\" x=\"161\" y=\"-272\">\r\n\t\t\t<label kind=\"exponentialrate\" x=\"170\" y=\"-306\">1</label>\r\n\t\t</location>\r\n\t\t<init ref=\"id2\"/>\r\n\t\t<transition>\r\n\t\t\t<source ref=\"id1\"/>\r\n\t\t\t<target ref=\"id2\"/>\r\n\t\t\t<label kind=\"synchronisation\" x=\"76\" y=\"-170\">c_e[id+1]!</label>\r\n\t\t\t<nail x=\"161\" y=\"-170\"/>\r\n\t\t</transition>\r\n\t\t<transition>\r\n\t\t\t<source ref=\"id0\"/>\r\n\t\t\t<target ref=\"id2\"/>\r\n\t\t\t<label kind=\"synchronisation\" x=\"195\" y=\"-170\">c_e[id+1]!</label>\r\n\t\t\t<nail x=\"161\" y=\"-170\"/>\r\n\t\t</transition>\r\n\t\t<transition>\r\n\t\t\t<source ref=\"id2\"/>\r\n\t\t\t<target ref=\"id0\"/>\r\n\t\t\t<label kind=\"guard\" x=\"221\" y=\"-255\">iteration != i</label>\r\n\t\t\t<label kind=\"synchronisation\" x=\"221\" y=\"-272\">c_e[id]?</label>\r\n\t\t</transition>\r\n\t\t<transition>\r\n\t\t\t<source ref=\"id2\"/>\r\n\t\t\t<target ref=\"id1\"/>\r\n\t\t\t<label kind=\"guard\" x=\"8\" y=\"-297\">iteration == i</label>\r\n\t\t\t<label kind=\"synchronisation\" x=\"8\" y=\"-314\">c_e[id]?</label>\r\n\t\t\t<label kind=\"assignment\" x=\"8\" y=\"-280\">s[id_state] := status</label>\r\n\t\t</transition>\r\n\t</template>\r\n");
	}
    }

    private void createTemporalOperators() throws IOException {
	if (FakeData.S_STR_NO > 0) {
	    result.append(
		    "\t<template>\n\t\t<name>S_SRT</name>\n\t\t<parameter>const id_bop id, const iter bound, const id_s id_state, const bool status</parameter>\n\t\t<declaration>int counter:=0;\nbool f:= false;\nbool t:=true;\n\nvoid count(){\n     if(counter == 32767){\n        counter := 1;\n     }else{\n        counter++;\n     }\n}</declaration>\n\t\t<location id=\"id78\" x=\"-76\" y=\"-382\">\n\t\t\t<name x=\"-51\" y=\"-408\">Check</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-102\" y=\"-391\">1</label>\n\t\t</location>\n\t\t<location id=\"id79\" x=\"68\" y=\"-212\">\n\t\t\t<name x=\"-51\" y=\"-187\">Transition_True</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"85\" y=\"-203\">1</label>\n\t\t</location>\n\t\t<location id=\"id80\" x=\"-212\" y=\"-212\">\n\t\t\t<name x=\"-204\" y=\"-187\">Transition_False</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-204\" y=\"-237\">1</label>\n\t\t</location>\n\t\t<location id=\"id81\" x=\"-76\" y=\"-280\">\n\t\t\t<name x=\"-51\" y=\"-289\">Transition</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-102\" y=\"-289\">1</label>\n\t\t</location>\n\t\t<location id=\"id82\" x=\"246\" y=\"-271\">\n\t\t\t<name x=\"263\" y=\"-280\">True</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"263\" y=\"-263\">1</label>\n\t\t</location>\n\t\t<location id=\"id83\" x=\"-365\" y=\"-271\">\n\t\t\t<name x=\"-425\" y=\"-280\">False</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-390\" y=\"-297\">1</label>\n\t\t</location>\n\t\t<init ref=\"id83\"/>\n\t\t<transition>\n\t\t\t<source ref=\"id78\"/>\n\t\t\t<target ref=\"id81\"/>\n\t\t\t<label kind=\"guard\" x=\"-25\" y=\"-348\">s[id_state] == status</label>\n\t\t\t<label kind=\"assignment\" x=\"-25\" y=\"-331\">count()</label>\n\t\t\t<nail x=\"-42\" y=\"-331\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id78\"/>\n\t\t\t<target ref=\"id81\"/>\n\t\t\t<label kind=\"guard\" x=\"-246\" y=\"-340\">s[id_state] != status</label>\n\t\t\t<label kind=\"assignment\" x=\"-195\" y=\"-323\">counter := 0</label>\n\t\t\t<nail x=\"-110\" y=\"-331\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id80\"/>\n\t\t\t<target ref=\"id83\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"-340\" y=\"-204\">c_bop[id+1]!</label>\n\t\t\t<nail x=\"-365\" y=\"-212\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id79\"/>\n\t\t\t<target ref=\"id82\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"127\" y=\"-204\">c_bop[id+1]!</label>\n\t\t\t<nail x=\"246\" y=\"-212\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id81\"/>\n\t\t\t<target ref=\"id79\"/>\n\t\t\t<label kind=\"guard\" x=\"-59\" y=\"-246\">counter &gt;= bound</label>\n\t\t\t<label kind=\"assignment\" x=\"-58\" y=\"-212\">s_bop[id]:= true</label>\n\t\t\t<nail x=\"-76\" y=\"-212\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id81\"/>\n\t\t\t<target ref=\"id80\"/>\n\t\t\t<label kind=\"guard\" x=\"-221\" y=\"-255\">counter &lt; bound</label>\n\t\t\t<label kind=\"assignment\" x=\"-194\" y=\"-212\">s_bop[id] := false</label>\n\t\t\t<nail x=\"-77\" y=\"-212\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id82\"/>\n\t\t\t<target ref=\"id78\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"68\" y=\"-450\">c_bop[id]?</label>\n\t\t\t<nail x=\"246\" y=\"-425\"/>\n\t\t\t<nail x=\"-76\" y=\"-425\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id83\"/>\n\t\t\t<target ref=\"id78\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"-263\" y=\"-450\">c_bop[id]?</label>\n\t\t\t<nail x=\"-365\" y=\"-425\"/>\n\t\t\t<nail x=\"-76\" y=\"-425\"/>\n\t\t</transition>\n\t</template>");
	}
	if (FakeData.S_WTR_NO > 0) {
	    result.append(
		    "\t<template>\n\t\t<name>S_WRT</name>\n\t\t<parameter>const id_bop id, const iter bound, const id_s id_state, const bool status</parameter>\n\t\t<declaration>int counter:=0;\nint lastTrue:= 0 - bound;\nbool f:= false;\nbool t:=true;\n\nvoid count(){\n        if(counter == 32767){\n            counter := bound;\n        }else{\n            counter++;\n        }\n}</declaration>\n\t\t<location id=\"id84\" x=\"76\" y=\"-42\">\n\t\t\t<name x=\"25\" y=\"-25\">Transition_True</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"85\" y=\"-68\">1</label>\n\t\t</location>\n\t\t<location id=\"id85\" x=\"-204\" y=\"-42\">\n\t\t\t<name x=\"-255\" y=\"-17\">Transition_False</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-196\" y=\"-67\">1</label>\n\t\t</location>\n\t\t<location id=\"id86\" x=\"-68\" y=\"-153\">\n\t\t\t<name x=\"-43\" y=\"-162\">Transition</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-94\" y=\"-162\">1</label>\n\t\t</location>\n\t\t<location id=\"id87\" x=\"221\" y=\"-102\">\n\t\t\t<name x=\"238\" y=\"-111\">True</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"238\" y=\"-94\">1</label>\n\t\t</location>\n\t\t<location id=\"id88\" x=\"-314\" y=\"-102\">\n\t\t\t<name x=\"-374\" y=\"-111\">False</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-339\" y=\"-128\">1</label>\n\t\t</location>\n\t\t<init ref=\"id88\"/>\n\t\t<transition>\n\t\t\t<source ref=\"id85\"/>\n\t\t\t<target ref=\"id88\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"-297\" y=\"-68\">c_bop[id+1]!</label>\n\t\t\t<nail x=\"-314\" y=\"-42\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id84\"/>\n\t\t\t<target ref=\"id87\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"161\" y=\"-34\">c_bop[id+1]!</label>\n\t\t\t<nail x=\"221\" y=\"-42\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id86\"/>\n\t\t\t<target ref=\"id84\"/>\n\t\t\t<label kind=\"guard\" x=\"-59\" y=\"8\">s[id_state] == status</label>\n\t\t\t<label kind=\"assignment\" x=\"-59\" y=\"25\">s_bop[id]:= true, lastTrue := iteration</label>\n\t\t\t<nail x=\"-68\" y=\"-42\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id86\"/>\n\t\t\t<target ref=\"id85\"/>\n\t\t\t<label kind=\"guard\" x=\"-314\" y=\"-136\">(iteration - lastTrue) &gt; bound &amp;&amp; s[id_state] != status</label>\n\t\t\t<label kind=\"assignment\" x=\"-195\" y=\"-102\">s_bop[id] := false</label>\n\t\t\t<nail x=\"-69\" y=\"-42\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id87\"/>\n\t\t\t<target ref=\"id86\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"229\" y=\"-178\">c_bop[id]?</label>\n\t\t\t<nail x=\"221\" y=\"-255\"/>\n\t\t\t<nail x=\"-68\" y=\"-255\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id88\"/>\n\t\t\t<target ref=\"id86\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"-399\" y=\"-204\">c_bop[id]?</label>\n\t\t\t<nail x=\"-314\" y=\"-255\"/>\n\t\t\t<nail x=\"-68\" y=\"-255\"/>\n\t\t</transition>\n\t</template>");
	}
	if (FakeData.S_SAT_NO > 0) {
	    result.append(
		    "\t<template>\n\t\t<name>S_SAT</name>\n\t\t<parameter>const id_bop id, const iter low_bound, const iter upp_bound,const id_s id_state, const bool status</parameter>\n\t\t<declaration>bool alwaysTrue:= true;\n\nvoid update(){\n        s_bop[id] := alwaysTrue;\n}\n</declaration>\n\t\t<location id=\"id89\" x=\"229\" y=\"-144\">\n\t\t\t<name x=\"246\" y=\"-153\">Wait</name>\n\t\t</location>\n\t\t<location id=\"id90\" x=\"-68\" y=\"-255\">\n\t\t\t<label kind=\"exponentialrate\" x=\"-94\" y=\"-264\">1</label>\n\t\t</location>\n\t\t<location id=\"id91\" x=\"-348\" y=\"-144\">\n\t\t\t<name x=\"-425\" y=\"-152\">Evaluate</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-340\" y=\"-169\">1</label>\n\t\t</location>\n\t\t<location id=\"id92\" x=\"-348\" y=\"-255\">\n\t\t\t<label kind=\"exponentialrate\" x=\"-373\" y=\"-281\">1</label>\n\t\t</location>\n\t\t<init ref=\"id90\"/>\n\t\t<transition>\n\t\t\t<source ref=\"id90\"/>\n\t\t\t<target ref=\"id89\"/>\n\t\t\t<label kind=\"guard\" x=\"0\" y=\"-212\">iteration &lt; low_bound</label>\n\t\t\t<label kind=\"synchronisation\" x=\"0\" y=\"-195\">c_bop[id]?</label>\n\t\t\t<nail x=\"-34\" y=\"-170\"/>\n\t\t\t<nail x=\"212\" y=\"-170\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id91\"/>\n\t\t\t<target ref=\"id92\"/>\n\t\t\t<label kind=\"guard\" x=\"-297\" y=\"-212\">s[id_state] == status</label>\n\t\t\t<nail x=\"-306\" y=\"-195\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id89\"/>\n\t\t\t<target ref=\"id90\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"68\" y=\"-289\">c_bop[id+1]!</label>\n\t\t\t<nail x=\"229\" y=\"-255\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id90\"/>\n\t\t\t<target ref=\"id89\"/>\n\t\t\t<label kind=\"guard\" x=\"0\" y=\"-127\">iteration &gt; upp_bound</label>\n\t\t\t<label kind=\"synchronisation\" x=\"34\" y=\"-144\">c_bop[id]?</label>\n\t\t\t<label kind=\"assignment\" x=\"42\" y=\"-110\">update()</label>\n\t\t\t<nail x=\"-68\" y=\"-144\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id91\"/>\n\t\t\t<target ref=\"id92\"/>\n\t\t\t<label kind=\"guard\" x=\"-527\" y=\"-212\">s[id_state] != status</label>\n\t\t\t<label kind=\"assignment\" x=\"-527\" y=\"-195\">alwaysTrue := false</label>\n\t\t\t<nail x=\"-391\" y=\"-195\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id90\"/>\n\t\t\t<target ref=\"id91\"/>\n\t\t\t<label kind=\"guard\" x=\"-399\" y=\"-127\">iteration &gt;= low_bound &amp;&amp; iteration &lt;= upp_bound</label>\n\t\t\t<label kind=\"synchronisation\" x=\"-263\" y=\"-144\">c_bop[id]?</label>\n\t\t\t<nail x=\"-68\" y=\"-144\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id92\"/>\n\t\t\t<target ref=\"id90\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"-246\" y=\"-289\">c_bop[id+1]!</label>\n\t\t\t<nail x=\"-297\" y=\"-255\"/>\n\t\t</transition>\n\t</template>\n");
	}
	if (FakeData.S_WAT_NO > 0) {
	    result.append(
		    "\t<template>\n\t\t<name>S_WAT</name>\n\t\t<parameter>const id_bop id, const iter low_bound, const iter upp_bound,const id_s id_state, const bool status</parameter>\n\t\t<declaration>bool atLeastOnceTrue:= false;\n\nvoid update(){\n        s_bop[id] := atLeastOnceTrue;\n}</declaration>\n\t\t<location id=\"id93\" x=\"43\" y=\"-111\">\n\t\t\t<label kind=\"exponentialrate\" x=\"17\" y=\"-120\">1</label>\n\t\t</location>\n\t\t<location id=\"id94\" x=\"340\" y=\"0\">\n\t\t\t<name x=\"357\" y=\"-9\">Wait</name>\n\t\t</location>\n\t\t<location id=\"id95\" x=\"-237\" y=\"0\">\n\t\t\t<name x=\"-314\" y=\"-8\">Evaluate</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-229\" y=\"-25\">1</label>\n\t\t</location>\n\t\t<location id=\"id96\" x=\"-237\" y=\"-111\">\n\t\t\t<label kind=\"exponentialrate\" x=\"-262\" y=\"-137\">1</label>\n\t\t</location>\n\t\t<init ref=\"id93\"/>\n\t\t<transition>\n\t\t\t<source ref=\"id93\"/>\n\t\t\t<target ref=\"id94\"/>\n\t\t\t<label kind=\"guard\" x=\"111\" y=\"-68\">iteration &lt; low_bound</label>\n\t\t\t<label kind=\"synchronisation\" x=\"111\" y=\"-51\">c_bop[id]?</label>\n\t\t\t<nail x=\"77\" y=\"-26\"/>\n\t\t\t<nail x=\"323\" y=\"-26\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id95\"/>\n\t\t\t<target ref=\"id96\"/>\n\t\t\t<label kind=\"guard\" x=\"-195\" y=\"-68\">s[id_state] == status</label>\n\t\t\t<label kind=\"assignment\" x=\"-195\" y=\"-51\">atLeastOnceTrue := true</label>\n\t\t\t<nail x=\"-195\" y=\"-51\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id94\"/>\n\t\t\t<target ref=\"id93\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"179\" y=\"-145\">c_bop[id+1]!</label>\n\t\t\t<nail x=\"340\" y=\"-111\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id93\"/>\n\t\t\t<target ref=\"id94\"/>\n\t\t\t<label kind=\"guard\" x=\"111\" y=\"17\">iteration &gt; upp_bound</label>\n\t\t\t<label kind=\"synchronisation\" x=\"145\" y=\"0\">c_bop[id]?</label>\n\t\t\t<label kind=\"assignment\" x=\"153\" y=\"34\">update()</label>\n\t\t\t<nail x=\"43\" y=\"0\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id95\"/>\n\t\t\t<target ref=\"id96\"/>\n\t\t\t<label kind=\"guard\" x=\"-416\" y=\"-68\">s[id_state] != status</label>\n\t\t\t<nail x=\"-280\" y=\"-51\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id93\"/>\n\t\t\t<target ref=\"id95\"/>\n\t\t\t<label kind=\"guard\" x=\"-288\" y=\"17\">iteration &gt;= low_bound &amp;&amp; iteration &lt;= upp_bound</label>\n\t\t\t<label kind=\"synchronisation\" x=\"-152\" y=\"0\">c_bop[id]?</label>\n\t\t\t<nail x=\"43\" y=\"0\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id96\"/>\n\t\t\t<target ref=\"id93\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"-135\" y=\"-145\">c_bop[id+1]!</label>\n\t\t\t<nail x=\"-186\" y=\"-111\"/>\n\t\t</transition>\n\t</template>");
	}
    }

    private void createNextTimeRules() throws IOException {
	for (int i = 0; i < systemData.getNtrs().size(); i++) {
	    result.append("\t<template>\n\t\t<name>NTR_" + i
		    + "</name>\n\t\t<declaration>bool nextTime:= false;\nint id:=" + i
		    + ";</declaration>\n\t\t<location id=\"id30\" x=\"-51\" y=\"59\">\n\t\t\t<label kind=\"exponentialrate\" x=\"-61\" y=\"93\">1</label>\n\t\t</location>\n\t\t<location id=\"id31\" x=\"-51\" y=\"127\">\n\t\t\t<label kind=\"exponentialrate\" x=\"-61\" y=\"161\">1</label>\n\t\t</location>\n\t\t<location id=\"id32\" x=\"-51\" y=\"-17\">\n\t\t\t<name x=\"-34\" y=\"-26\">Wait</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-61\" y=\"17\">1</label>\n\t\t</location>\n\t\t<location id=\"id33\" x=\"-153\" y=\"-119\">\n\t\t\t<name x=\"-255\" y=\"-127\">NotTriggered</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"-162\" y=\"-153\">1</label>\n\t\t</location>\n\t\t<location id=\"id34\" x=\"51\" y=\"-119\">\n\t\t\t<name x=\"68\" y=\"-128\">Triggered</name>\n\t\t\t<label kind=\"exponentialrate\" x=\"68\" y=\"-145\">1</label>\n\t\t</location>\n\t\t<location id=\"id35\" x=\"-42\" y=\"-213\">\n\t\t\t<label kind=\"exponentialrate\" x=\"-52\" y=\"-179\">1</label>\n\t\t</location>\n\t\t<init ref=\"id35\"/>\n\t\t<transition>\n\t\t\t<source ref=\"id30\"/>\n\t\t\t<target ref=\"id35\"/>\n\t\t\t<label kind=\"guard\" x=\"204\" y=\"-85\">reset == true</label>\n\t\t\t<label kind=\"synchronisation\" x=\"204\" y=\"-68\">c_ntr[id+1]!</label>\n\t\t\t<nail x=\"187\" y=\"59\"/>\n\t\t\t<nail x=\"187\" y=\"-213\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id30\"/>\n\t\t\t<target ref=\"id31\"/>\n\t\t\t<label kind=\"guard\" x=\"-348\" y=\"85\">nextTime == false &amp;&amp; reset == false</label>\n\t\t\t<nail x=\"-119\" y=\"93\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id30\"/>\n\t\t\t<target ref=\"id31\"/>\n\t\t\t<label kind=\"guard\" x=\"34\" y=\"85\">nextTime == true &amp;&amp; reset == false</label>\n\t\t\t<label kind=\"assignment\" x=\"34\" y=\"102\">s["
		    + (i + 1)
		    + "]:= true</label>\n\t\t\t<nail x=\"17\" y=\"93\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id32\"/>\n\t\t\t<target ref=\"id30\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"-34\" y=\"8\">c_ntr[id]?</label>\n\t\t\t<nail x=\"-51\" y=\"17\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id31\"/>\n\t\t\t<target ref=\"id35\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"-450\" y=\"25\">c_ntr[id+1]!</label>\n\t\t\t<nail x=\"-374\" y=\"127\"/>\n\t\t\t<nail x=\"-374\" y=\"-213\"/>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id33\"/>\n\t\t\t<target ref=\"id32\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"-170\" y=\"-68\">c_ntr[id+1]!</label>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id34\"/>\n\t\t\t<target ref=\"id32\"/>\n\t\t\t<label kind=\"synchronisation\" x=\"26\" y=\"-77\">c_ntr[id+1]!</label>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id35\"/>\n\t\t\t<target ref=\"id33\"/>\n\t\t\t<label kind=\"guard\" x=\"-280\" y=\"-179\">s["
		    + i + "] == false || s[" + ((FakeData.STATE_NO / 2) + i + 1)
		    + "] == false</label>\n\t\t\t<label kind=\"synchronisation\" x=\"-170\" y=\"-196\">c_ntr[id]?</label>\n\t\t\t<label kind=\"assignment\" x=\"-255\" y=\"-162\">nextTime := false</label>\n\t\t</transition>\n\t\t<transition>\n\t\t\t<source ref=\"id35\"/>\n\t\t\t<target ref=\"id34\"/>\n\t\t\t<label kind=\"guard\" x=\"34\" y=\"-187\">s["
		    + i + "] == true &amp;&amp; s[" + ((FakeData.STATE_NO / 2) + i + 1)
		    + "] == true</label>\n\t\t\t<label kind=\"synchronisation\" x=\"34\" y=\"-204\">c_ntr[id]?</label>\n\t\t\t<label kind=\"assignment\" x=\"34\" y=\"-170\">nextTime:= true</label>\n\t\t</transition>\n\t</template>");
	}
    }

}
